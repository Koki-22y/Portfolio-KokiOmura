æ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€WebSocket ã‚’ç”¨ã„ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«å–å¾—ã—ãŸ ADS-Bï¼ˆèˆªç©ºæ©Ÿä½ç½®æƒ…å ±ï¼‰ãƒ‡ãƒ¼ã‚¿ ã‚’åé›†ãƒ»å‡¦ç†ã—ã€
é«˜åº¦ãƒ»é€Ÿåº¦ãƒ»ä½ç½®ãªã©ã‚’å«ã‚€èˆªç©ºæ©Ÿãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”Ÿæˆã™ã‚‹å®Ÿé¨“çš„ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

Notebook å†…ã§ã¯ä»¥ä¸‹ã®å‡¦ç†ã‚’è¡Œã£ã¦ã„ã¾ã™ï¼š

WebSocket ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰èˆªç©ºæ©Ÿãƒ‡ãƒ¼ã‚¿ã‚’å—
JSON ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è§£æã—å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º

é«˜åº¦ãŒ 10 km ä»¥ä¸Šã®èˆªç©ºæ©Ÿã‚’æ¤œå‡ºã—ã¦é€šçŸ¥

pandas DataFrame ã¨ã—ã¦æ§‹é€ åŒ–

é€£ç¶šçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ãƒ»è“„ç©ã— CSV ã¨ã—ã¦ä¿å­˜

å¾Œç¶šã®å¯è¦–åŒ–ã‚„è§£æã®ãŸã‚ã®ç´ æã‚’ä½œæˆ

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ èˆªç©ºãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸè§£æåŸºç›¤ã®å…¥é–€ã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚

 ä½¿ç”¨æŠ€è¡“

Python

WebSocketï¼ˆwebsockets ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰

pandas

JSON

Jupyter Notebook

 1. WebSocket ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—

Notebook ã§ã¯ websockets ã® sync API ã‚’ä½¿ç”¨ã—ã¦
ADS-B ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆws://192.87.172.71:1338ï¼‰ã«æ¥ç¶šã—ã¾ã™ã€‚

from websockets.sync.client import connect
import json
import pandas as pd

data = []

def receive_data():
    max_msg = 100
    with connect("ws://192.87.172.71:1338") as websocket:
        for _ in range(max_msg):
            message = websocket.recv()
            msg = json.loads(message)
            handle_message(msg)
            data.append(msg)

 2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡¦ç†

é«˜åº¦ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€
é«˜åº¦ 10 km ä»¥ä¸Šï¼ˆ= 10,000 mï¼‰ã®æ©Ÿä½“ã‚’æ¤œå‡ºã™ã‚‹ã¨é€šçŸ¥ã—ã¾ã™ã€‚

def handle_message(msg):
    if 'altitude' in msg:
        if msg['altitude'] * 0.3048 >= 10000:
            print("Plane {} is at 10km or higher!".format(msg['address']))


altitude ã¯ãƒ•ã‚£ãƒ¼ãƒˆè¡¨è¨˜ã®ãŸã‚ã€ãƒ¡ãƒ¼ãƒˆãƒ«ã¸å¤‰æ›ã—ã¦è©•ä¾¡ã—ã¾ã™ã€‚

 3. ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ åŒ–

Notebook ã§ã¯ CSV ã®èª­ã¿è¾¼ã¿ãƒ»ä¿å­˜ã‚‚è¡Œã„ãªãŒã‚‰ã€
å–å¾—ã—ãŸ ADS-B ãƒ‡ãƒ¼ã‚¿ã‚’ pandas DataFrame ã«ã¾ã¨ã‚ã¾ã™ã€‚

df = pd.read_csv('planes_total.csv')


æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’é€£ç¶šã§å—ä¿¡ã— DataFrame ã«è¿½åŠ ã™ã‚‹å‡¦ç†ï¼š

count = 0
while count < 150:
    receive_data()
    new_df = pd.DataFrame(data)
    df = pd.concat([df, new_df], ignore_index=True)
    count += 1

 4. ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜

åé›†ã—ãŸèˆªç©ºæ©Ÿãƒ‡ãƒ¼ã‚¿ã¯ CSV ã¨ã—ã¦ä¿å­˜å¯èƒ½ã§ã™ï¼š

df.to_csv("planes_total.csv", index=False)


ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ã€å¾Œã§åœ°å›³ä¸Šã«ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã‚Šã€
èˆªç©ºæ©Ÿã®ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æãƒ»å¯è¦–åŒ–ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

 5. ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã‚‹ä¸»ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¾‹

èˆªç©ºæ©Ÿã‹ã‚‰å—ä¿¡ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã«ã¯ä»¥ä¸‹ãŒå«ã¾ã‚Œã¾ã™ï¼š

ICAO ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆaddressï¼‰

çµŒåº¦ãƒ»ç·¯åº¦ï¼ˆlat, lonï¼‰

é«˜åº¦ï¼ˆaltitudeï¼‰

é€Ÿåº¦ï¼ˆspeedï¼‰

ä¸Šæ˜‡ï¼ä¸‹é™ï¼ˆvertical_speedï¼‰

ã‚³ãƒ¼ãƒ«ã‚µã‚¤ãƒ³ï¼ˆcallsignï¼‰

ã‚µãƒ¼ãƒãƒ¼ãŒé€ä¿¡ã™ã‚‹ JSON ã«ã‚ˆã‚Šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®çµ„ã¿åˆã‚ã›ã¯ç•°ãªã‚Šã¾ã™ã€‚

ğŸ›  å¿…è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
pip install websockets pandas


ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã§ Notebook ã‚’é–‹ãå ´åˆã¯ Jupyter ã‚‚ï¼‰

 æ³¨æ„äº‹é …

å–å¾—ã—ã¦ã„ã‚‹ WebSocket ãƒ‡ãƒ¼ã‚¿ã¯å¤–éƒ¨ã®ãƒ†ã‚¹ãƒˆç”¨ã‚µãƒ¼ãƒãƒ¼ã«ä¾å­˜ã—ã¾ã™

ã‚µãƒ¼ãƒãƒ¼ã®å¯ç”¨æ€§ã‚„ãƒ‡ãƒ¼ã‚¿å½¢å¼ãŒå¤‰ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™

é•·æ™‚é–“ã®é€£ç¶šå–å¾—ã¯é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™